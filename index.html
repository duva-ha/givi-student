<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-TECH Hub 2026 - Student Hub Official</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <script src="bai1-10.js" defer></script>
    <script src="bai2-10.js" defer></script>
    <script src="bai3-10.js" defer></script>
    <script src="bai4-10.js" defer></script>
    <script src="bai1-11.js" defer></script>
    <script src="bai2-11.js" defer></script>
    <script src="bai1-12.js" defer></script>
    <script src="bai2-12.js" defer></script>
    <script src="quizzes.js" defer></script>
    <script src="LTAP1.js" defer></script>
    <script src="LTAP2.js" defer></script>
    <script src="TLIEU1.js" defer></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #fdfdfb; margin: 0; overflow: hidden; color: #334155; }
        aside { background: #1e293b; width: 260px; flex-shrink: 0; transition: all 0.4s ease; }
        .nav-active { background: rgba(255,255,255,0.1); border-left: 3px solid #3b82f6; color: white; }
        .custom-scroll::-webkit-scrollbar { width: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .modal-overlay { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); }
        .hide-sidebar { transform: translateX(-100%); width: 0 !important; opacity: 0; }
        .logout-btn:hover { background: rgba(244, 63, 94, 0.15); color: #fb7185; }
        .lesson-item { cursor: pointer; transition: 0.3s; border: 1px solid transparent; border-radius: 1rem; }
        .lesson-item.active { background: #fff; border-color: #e2e8f0; shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyAV-XVaOyUiq1c-29VTaWjLKcEXrssnnTE",
            authDomain: "qlhs10a7.firebaseapp.com",
            projectId: "qlhs10a7",
            storageBucket: "qlhs10a7.firebasestorage.app",
            appId: "1:584229565603:web:d47a10f0a512a1a309bb16"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const shuffle = (arr) => [...arr].sort(() => Math.random() - 0.5);

        // --- MODAL LUY·ªÜN T·∫¨P ---
        function PracticeModal({ quiz, onClose }) {
            const [timeLeft, setTimeLeft] = useState(quiz.time);
            const [answers, setAnswers] = useState({});
            const [isSubmitted, setIsSubmitted] = useState(false);
            const [score, setScore] = useState(0);

            useEffect(() => {
                if (timeLeft <= 0) { submit(); return; }
                const timer = setInterval(() => setTimeLeft(t => t - 1), 1000);
                return () => clearInterval(timer);
            }, [timeLeft]);

            const submit = () => {
                let correct = 0;
                quiz.questions.forEach((q, i) => { if (answers[i] === q.c) correct++; });
                setScore(((correct / quiz.questions.length) * 10).toFixed(1));
                setIsSubmitted(true);
            };

            return (
                <div className="fixed inset-0 z-[100] modal-overlay flex items-center justify-center p-4">
                    <div className="bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl flex flex-col max-h-[90vh] overflow-hidden">
                        <div className="p-5 border-b bg-emerald-50 flex justify-between items-center">
                            <span className="font-black text-[10px] text-emerald-700 uppercase tracking-widest">Luy·ªán t·∫≠p: {quiz.title}</span>
                            {!isSubmitted && <span className="text-emerald-600 font-bold font-mono">‚è±Ô∏è {Math.floor(timeLeft/60)}:{(timeLeft%60).toString().padStart(2,'0')}</span>}
                        </div>
                        <div className="p-10 overflow-y-auto custom-scroll flex-1">
                            {!isSubmitted ? quiz.questions.map((q, i) => (
                                <div key={i} className="mb-8 border-b pb-6 border-slate-50 animate-in fade-in duration-500">
                                    <p className="font-bold text-lg mb-6">{i+1}. {q.q}</p>
                                    <div className="grid gap-2">
                                        {q.a.map((opt, idx) => (
                                            <button key={idx} onClick={() => setAnswers({...answers, [i]: opt})} className={`p-4 rounded-xl border-2 text-left text-sm transition-all ${answers[i] === opt ? 'border-emerald-500 bg-emerald-50 text-emerald-700 font-bold' : 'border-slate-100 hover:bg-slate-50'}`}>{opt}</button>
                                        ))}
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center py-10">
                                    <div className="text-7xl font-black text-emerald-600 mb-4">{score}</div>
                                    <p className="text-slate-400 font-bold uppercase text-[10px] mb-8">K·∫øt qu·∫£ luy·ªán t·∫≠p t·ª± do</p>
                                    <div className="flex flex-col gap-3 max-w-xs mx-auto">
                                        <button onClick={() => { setIsSubmitted(false); setAnswers({}); setTimeLeft(quiz.time); }} className="w-full py-4 bg-emerald-600 text-white rounded-2xl font-black uppercase text-[10px]">L√†m l·∫°i ngay</button>
                                        <button onClick={onClose} className="w-full py-4 bg-slate-100 text-slate-500 rounded-2xl font-black uppercase text-[10px]">Tho√°t</button>
                                    </div>
                                </div>
                            )}
                        </div>
                        {!isSubmitted && <div className="p-6 border-t"><button onClick={submit} className="w-full py-4 bg-emerald-600 text-white rounded-2xl font-black uppercase text-xs">N·ªôp b√†i luy·ªán t·∫≠p</button></div>}
                    </div>
                </div>
            );
        }

        // --- MODAL KI·ªÇM TRA ---
        function QuizModal({ quiz, user, onClose }) {
            const [timeLeft, setTimeLeft] = useState(quiz.time);
            const [answers, setAnswers] = useState({});
            const [isSubmitted, setIsSubmitted] = useState(false);
            const [score, setScore] = useState(0);

            useEffect(() => {
                if (timeLeft <= 0) { handleFinalSubmit(); return; }
                const timer = setInterval(() => setTimeLeft(t => t - 1), 1000);
                return () => clearInterval(timer);
            }, [timeLeft]);

            const handleFinalSubmit = async () => {
                if (isSubmitted) return;
                let correct = 0;
                quiz.questions.forEach((q, i) => { if (answers[i] === q.c) correct++; });
                const finalScore = ((correct / quiz.questions.length) * 10).toFixed(1);
                setScore(finalScore);
                setIsSubmitted(true);
                try {
                    await db.collection("quiz_results").add({
                        studentName: user.displayName, studentEmail: user.email,
                        quizId: quiz.id, quizTitle: quiz.title, score: finalScore,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                } catch (e) { console.error(e); }
            };

            return (
                <div className="fixed inset-0 z-[100] modal-overlay flex items-center justify-center p-4">
                    <div className="bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl flex flex-col max-h-[90vh] overflow-hidden">
                        <div className="p-6 border-b bg-slate-50 flex justify-between items-center">
                            <span className="font-black text-[10px] uppercase tracking-widest">{quiz.title}</span>
                            {!isSubmitted && <span className="text-rose-600 font-bold">‚è±Ô∏è {Math.floor(timeLeft/60)}:{(timeLeft%60).toString().padStart(2,'0')}</span>}
                        </div>
                        <div className="p-10 overflow-y-auto custom-scroll flex-1">
                            {!isSubmitted ? quiz.questions.map((q, i) => (
                                <div key={i} className="mb-8 border-b pb-8 border-slate-50">
                                    <p className="font-bold text-lg mb-6">{i+1}. {q.q}</p>
                                    <div className="grid gap-2">
                                        {q.a.map((opt, idx) => (
                                            <button key={idx} onClick={() => setAnswers({...answers, [i]: opt})} className={`p-4 rounded-xl border-2 text-left text-sm ${answers[i] === opt ? 'border-blue-500 bg-blue-50 text-blue-700 font-bold' : 'border-slate-100'}`}>{opt}</button>
                                        ))}
                                    </div>
                                </div>
                            )) : (
                                <div className="text-center py-10">
                                    <div className="text-7xl font-black text-blue-600 mb-4">{score}</div>
                                    <p className="font-bold text-slate-400 uppercase text-[10px]">K·∫øt qu·∫£ ƒë√£ g·ª≠i t·ªõi gi√°o vi√™n</p>
                                    <button onClick={onClose} className="mt-8 px-10 py-3 bg-slate-900 text-white rounded-xl font-bold uppercase text-[10px]">ƒê√≥ng</button>
                                </div>
                            )}
                        </div>
                        {!isSubmitted && <div className="p-6 border-t"><button onClick={handleFinalSubmit} className="w-full py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs">N·ªôp b√†i ch√≠nh th·ª©c</button></div>}
                    </div>
                </div>
            );
        }

        function App() {
            const [user, setUser] = useState(null);
            const [tab, setTab] = useState('baigiang');
            const [grade, setGrade] = useState('11');
            const [ls, setLs] = useState(null);
            const [activeQuiz, setActiveQuiz] = useState(null);
            const [activePractice, setActivePractice] = useState(null);
            const [isFocus, setIsFocus] = useState(false);
            const [doneQuizzes, setDoneQuizzes] = useState([]);
            
            const [localLessons, setLocalLessons] = useState({ "10": [], "11": [], "12": [] });
            const [practiceData, setPracticeData] = useState([]);
            const [docData, setDocData] = useState([]);

            const handleLogout = () => {
                if (window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën tho√°t ·ª©ng d·ª•ng?")) {
                    auth.signOut().then(() => window.location.reload());
                }
            };

            const scanData = useCallback(() => {
                const resLessons = { "10": [], "11": [], "12": [] };
                ["10", "11", "12"].forEach(g => {
                    for (let i = 1; i <= 20; i++) {
                        const d = window[`D${g}_B${i}`];
                        if (d) resLessons[g].push({ ...d, lessonIndex: i });
                    }
                });
                const resP = []; const resD = [];
                for (let i = 1; i <= 10; i++) {
                    if (window[`LTAP${i}`]) resP.push(window[`LTAP${i}`]);
                    if (window[`TLIEU${i}`]) resD.push(window[`TLIEU${i}`]);
                }
                setLocalLessons(resLessons);
                setPracticeData(resP);
                setDocData(resD);
            }, []);

            useEffect(() => {
                const unsub = auth.onAuthStateChanged(u => setUser(u));
                const timer = setInterval(scanData, 1000);
                return () => { unsub(); clearInterval(timer); };
            }, [scanData]);

            useEffect(() => {
                if (!user) return;
                return db.collection("quiz_results").where("studentEmail", "==", user.email)
                    .onSnapshot(s => setDoneQuizzes(s.docs.map(d => d.data().quizId)));
            }, [user]);

            useEffect(() => {
                const list = localLessons[grade];
                if (list && list.length > 0) setLs(list[0]); else setLs(null);
            }, [grade, localLessons]);

            const startQuiz = (q) => {
                let qs = shuffle(q.questions).map(item => ({ ...item, a: shuffle(item.a) }));
                setActiveQuiz({ ...q, questions: qs });
            };

            const startPractice = (p) => {
                let qs = shuffle(p.questions).map(item => ({ ...item, a: shuffle(item.a) }));
                setActivePractice({ ...p, questions: qs });
            };

            if (!user) return (
                <div className="h-screen flex items-center justify-center bg-slate-900">
                    <div className="text-center">
                        <div className="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center text-white font-black italic text-3xl shadow-xl mx-auto mb-6">E</div>
                        <button onClick={() => auth.signInWithPopup(new firebase.auth.GoogleAuthProvider())} className="bg-white text-slate-900 px-10 py-4 rounded-xl font-black uppercase text-[10px] tracking-widest shadow-xl">ƒêƒÉng nh·∫≠p b·∫±ng Google</button>
                    </div>
                </div>
            );

            return (
                <div className="flex h-screen overflow-hidden">
                    <aside className={`flex flex-col p-6 z-50 transition-all duration-500 shadow-xl ${isFocus ? 'hide-sidebar' : ''}`}>
                        <div className="mb-10 px-4 font-black text-2xl text-blue-500 italic uppercase">E-Tech Hub</div>
                        <nav className="flex-1 space-y-1">
                            {[
                                {id: 'baigiang', label: 'B√†i gi·∫£ng', icon: 'üìñ'},
                                {id: 'luyentap', label: 'Luy·ªán t·∫≠p', icon: 'üìù'},
                                {id: 'kiemtra', label: 'Ki·ªÉm tra', icon: 'üéØ'},
                                {id: 'tuliaeu', label: 'T∆∞ li·ªáu', icon: 'üìö'}
                            ].map(t => (
                                <button key={t.id} onClick={() => setTab(t.id)} className={`w-full flex items-center gap-4 px-6 py-4 text-[10px] font-black uppercase tracking-widest rounded-xl transition-all ${tab === t.id ? 'nav-active text-white shadow-md' : 'text-slate-500 hover:text-white'}`}>
                                    <span className="text-lg">{t.icon}</span> {t.label}
                                </button>
                            ))}
                        </nav>
                        <div className="mt-auto space-y-2">
                            <div className="p-3 bg-slate-800/50 rounded-2xl flex items-center gap-3 border border-white/5">
                                <img src={user.photoURL} className="w-8 h-8 rounded-full border border-blue-500" />
                                <div className="truncate flex-1 text-[9px] font-black text-white uppercase italic">{user.displayName}</div>
                            </div>
                            <button onClick={handleLogout} className="w-full flex items-center justify-center gap-2 p-3 rounded-xl text-[9px] font-bold uppercase tracking-widest text-slate-400 logout-btn transition-all">
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                                Tho√°t
                            </button>
                        </div>
                    </aside>

                    <main className="flex-1 bg-white relative rounded-l-[2.5rem] shadow-2xl overflow-hidden flex flex-col border-l border-slate-100">
                        <header className="h-14 px-8 border-b flex items-center justify-between bg-white/80 backdrop-blur-md z-40">
                             <div className="flex items-center gap-4 font-black text-[10px] uppercase text-slate-400">
                                <span>Kh·ªëi l·ªõp</span>
                                <select value={grade} onChange={e=>setGrade(e.target.value)} className="bg-transparent font-black text-blue-600 outline-none cursor-pointer">
                                    <option value="12">L·ªõp 12</option><option value="11">L·ªõp 11</option><option value="10">L·ªõp 10</option>
                                </select>
                            </div>
                            <button onClick={() => setIsFocus(!isFocus)} className="w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-100 text-slate-400">
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" /></svg>
                            </button>
                        </header>

                        <div className="flex-1 flex overflow-hidden">
                            {tab === 'baigiang' && (
                                <React.Fragment>
                                    <div className={`w-80 bg-slate-50/50 border-r p-6 overflow-y-auto custom-scroll space-y-2 ${isFocus ? 'hide-sidebar' : ''}`}>
                                        {localLessons[grade].map((l, idx) => (
                                            <div key={idx} onClick={()=>setLs(l)} className={`lesson-item p-4 ${ls?.id === l.id ? 'active bg-white' : 'hover:bg-white'}`}>
                                                <div className="text-[8px] font-black text-slate-300 uppercase mb-1">B√†i {l.lessonIndex}</div>
                                                <div className="font-bold text-xs text-slate-700">{l.title}</div>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="flex-1 p-16 overflow-y-auto custom-scroll">
                                        {ls && <div className="max-w-3xl mx-auto animate-in fade-in duration-700">
                                            <h2 className="text-4xl font-black mb-10 tracking-tighter leading-tight text-slate-800">{ls.title}</h2>
                                            <div className="bg-slate-50 p-10 rounded-[2.5rem] text-lg text-slate-600 leading-relaxed font-medium whitespace-pre-wrap italic shadow-inner border border-slate-100">{ls.content}</div>
                                        </div>}
                                    </div>
                                </React.Fragment>
                            )}

                            {tab === 'luyentap' && (
                                <div className="flex-1 p-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 overflow-y-auto custom-scroll h-fit">
                                    {practiceData.filter(p => p.grade === grade).map(item => (
                                        <div key={item.id} className="bg-white p-8 rounded-[2.5rem] border border-emerald-100 shadow-sm hover:shadow-xl transition-all h-80 flex flex-col justify-between group">
                                            <div className="w-14 h-14 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center text-3xl group-hover:bg-emerald-600 group-hover:text-white transition-all shadow-inner">üìù</div>
                                            <div><h4 className="text-xl font-black text-slate-800 mb-2 leading-tight">{item.title}</h4><p className="text-[10px] font-black text-slate-400 uppercase tracking-widest italic">L√†m l·∫°i v√¥ h·∫°n</p></div>
                                            <button onClick={() => startPractice(item)} className="w-full py-4 bg-emerald-600 text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-lg shadow-emerald-100">Luy·ªán t·∫≠p ngay</button>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {tab === 'kiemtra' && (
                                <div className="flex-1 p-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 overflow-y-auto custom-scroll h-fit">
                                    {window.E_TECH_QUIZZES?.filter(q => q.grade === grade).map(quiz => {
                                        const isDone = doneQuizzes.includes(quiz.id);
                                        return (
                                            <div key={quiz.id} className="bg-white p-8 rounded-[2.5rem] border border-slate-100 shadow-sm hover:shadow-xl transition-all h-80 flex flex-col justify-between">
                                                <div className="w-14 h-14 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center text-3xl">üéØ</div>
                                                <div><h4 className="text-xl font-black text-slate-800 mb-2 leading-tight">{quiz.title}</h4><p className="text-[10px] font-black text-slate-400 uppercase tracking-widest">{quiz.questions.length} c√¢u ‚Ä¢ Ch√≠nh th·ª©c</p></div>
                                                {isDone ? (<div className="bg-slate-100 text-slate-400 py-4 rounded-2xl text-center font-black text-[10px] uppercase italic">ƒê√£ n·ªôp b√†i</div>) : (<button onClick={() => startQuiz(quiz)} className="w-full py-4 bg-slate-900 text-white rounded-2xl font-black uppercase text-[10px] tracking-widest hover:bg-blue-600 transition-all">B·∫Øt ƒë·∫ßu thi</button>)}
                                            </div>
                                        );
                                    })}
                                </div>
                            )}

                            {tab === 'tuliaeu' && (
                                <div className="flex-1 p-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 overflow-y-auto custom-scroll h-fit">
                                    {docData.filter(d => d.grade === grade).map(item => (
                                        <div key={item.id} className="bg-white p-8 rounded-[2.5rem] border border-amber-100 shadow-sm hover:shadow-xl transition-all h-80 flex flex-col justify-between group">
                                            <div className="w-14 h-14 bg-amber-50 text-amber-600 rounded-2xl flex items-center justify-center text-3xl group-hover:bg-amber-600 group-hover:text-white transition-all shadow-inner">üìö</div>
                                            <div><h4 className="text-xl font-black text-slate-800 mb-2 leading-tight">{item.title}</h4><p className="text-[10px] font-black text-slate-400 uppercase tracking-widest italic">{item.description}</p></div>
                                            <a href={item.link} target="_blank" className="w-full py-4 bg-amber-600 text-white rounded-2xl font-black uppercase text-[10px] tracking-widest text-center shadow-lg shadow-amber-100">Xem t∆∞ li·ªáu</a>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </main>
                    {activeQuiz && <QuizModal quiz={activeQuiz} user={user} onClose={() => setActiveQuiz(null)} />}
                    {activePractice && <PracticeModal quiz={activePractice} onClose={() => setActivePractice(null)} />}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>

