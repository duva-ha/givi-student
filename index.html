<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>E-TECH Hub 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <script src="./data10/bai1-10.js" defer></script>
    <script src="./data10/bai2-10.js" defer></script>
    <script src="./data11/bai1-11.js" defer></script>
    <script src="./data12/bai1-12.js" defer></script>
    <script src="./data12/bai2-12.js" defer></script>

    <style>
        /* Gi·ªØ nguy√™n ph·∫ßn CSS c·ªßa b·∫°n */
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; overflow: hidden; }
        aside { background: #0f172a; color: #f8fafc; width: 280px; transition: all 0.4s; }
        .sidebar-active { background: linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%); color: white; border-radius: 1rem; }
        .lesson-card { background: white; border: 1px solid #e2e8f0; border-radius: 1rem; cursor: pointer; transition: 0.3s; margin-bottom: 8px; }
        .lesson-card.active { border-color: #0ea5e9; background: #f0f9ff; transform: translateX(4px); }
        .hide-left { transform: translateX(-100%); width: 0 !important; opacity: 0; pointer-events: none; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // C·∫•u h√¨nh Firebase (Gi·ªØ nguy√™n c·ªßa b·∫°n)
        const firebaseConfig = {
            apiKey: "AIzaSyAV-XVaOyUiq1c-29VTaWjLKcEXrssnnTE",
            authDomain: "qlhs10a7.firebaseapp.com",
            projectId: "qlhs10a7",
            storageBucket: "qlhs10a7.firebasestorage.app",
            appId: "1:584229565603:web:d47a10f0a512a1a309bb16"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        function App() {
            const [user, setUser] = useState(null);
            const [grade, setGrade] = useState('12');
            const [ls, setLs] = useState(null);
            const [isFocus, setIsFocus] = useState(false);
            const [allData, setAllData] = useState({ "10": [], "11": [], "12": [] });

            // H√ÄM QU√âT D·ªÆ LI·ªÜU: Ki·ªÉm tra window object xem c√≥ bi·∫øn kh√¥ng
            const refreshData = () => {
                const results = { "10": [], "11": [], "12": [] };
                ["10", "11", "12"].forEach(g => {
                    for (let i = 1; i <= 20; i++) {
                        // Ki·ªÉm tra bi·∫øn D10_B1, D12_B1...
                        const key = `D${g}_B${i}`;
                        if (window[key]) {
                            results[g].push(window[key]);
                        }
                    }
                });
                setAllData(results);
            };

            useEffect(() => {
                auth.onAuthStateChanged(u => setUser(u));
                
                // Th·ª≠ n·∫°p d·ªØ li·ªáu ngay
                refreshData();
                
                // Thi·∫øt l·∫≠p n·∫°p l·∫°i sau 1s v√† 3s ƒë·ªÉ ƒë·ª£i file JS t·∫£i xong ho√†n to√†n
                const t1 = setTimeout(refreshData, 1000);
                const t2 = setTimeout(refreshData, 3000);
                
                return () => { clearTimeout(t1); clearTimeout(t2); };
            }, []);

            useEffect(() => {
                if (allData[grade] && allData[grade].length > 0) {
                    setLs(allData[grade][0]);
                } else {
                    setLs(null);
                }
            }, [grade, allData]);

            if (!user) return <div className="h-screen flex items-center justify-center bg-slate-900"><button onClick={() => auth.signInWithPopup(new firebase.auth.GoogleAuthProvider())} className="bg-white px-8 py-3 rounded-full font-bold">ƒêƒÇNG NH·∫¨P</button></div>;

            return (
                <div className="flex h-screen overflow-hidden text-slate-900">
                    <aside className={`p-8 ${isFocus ? 'hide-left' : ''}`}>
                        <div className="mb-12 font-black text-2xl italic text-blue-500">E-TECH HUB</div>
                        <nav className="space-y-2">
                            <button className="sidebar-active w-full text-left p-4 font-bold text-sm">üìñ B√†i h·ªçc</button>
                        </nav>
                    </aside>

                    <main className="flex-1 bg-white relative rounded-l-[3rem] shadow-2xl overflow-hidden flex transition-all">
                        <div className={`w-80 bg-slate-50 border-r p-6 flex flex-col ${isFocus ? 'hide-left' : ''}`}>
                            <select value={grade} onChange={e=>setGrade(e.target.value)} className="w-full p-4 mb-6 rounded-2xl font-bold border border-slate-200 outline-none">
                                <option value="12">C√¥ng ngh·ªá 12</option>
                                <option value="11">C√¥ng ngh·ªá 11</option>
                                <option value="10">C√¥ng ngh·ªá 10</option>
                            </select>
                            <div className="flex-1 overflow-y-auto">
                                {allData[grade].length > 0 ? allData[grade].map(item => (
                                    <div key={item.id} onClick={()=>setLs(item)} className={`lesson-card p-5 ${ls?.id === item.id ? 'active' : ''}`}>
                                        <div className="text-[10px] font-bold text-slate-300 uppercase italic mb-1 text-slate-400">B√†i {item.id.split('-')[1]}</div>
                                        <div className="font-bold text-sm text-slate-700">{item.title}</div>
                                    </div>
                                )) : <div className="text-slate-400 text-center py-20 italic">ƒêang t·∫£i...</div>}
                            </div>
                        </div>

                        <div className="flex-1 p-12 overflow-y-auto relative">
                            <button onClick={() => setIsFocus(!isFocus)} className="fixed bottom-10 left-10 p-4 bg-slate-900 text-white rounded-2xl shadow-xl z-50">
                                {isFocus ? "üìÇ Hi·ªán Menu" : "üñ•Ô∏è To√†n m√†n h√¨nh"}
                            </button>
                            {ls ? (
                                <div className="max-w-4xl mx-auto">
                                    <h2 className="text-5xl font-black mb-8">{ls.title}</h2>
                                    <div className="bg-white border p-10 rounded-[2.5rem] mb-10 text-xl text-slate-600 leading-relaxed font-medium shadow-sm">
                                        {ls.content}
                                    </div>
                                    <div className="bg-emerald-50 p-8 rounded-[2rem] border-l-4 border-emerald-500">
                                        <div className="font-black text-[10px] text-emerald-600 mb-4 tracking-widest">üí° H∆Ø·ªöNG D·∫™N H·ªåC T·∫¨P</div>
                                        <p className="italic text-slate-700 font-bold text-lg">{ls.instruction}</p>
                                    </div>
                                </div>
                            ) : (
                                <div className="h-full flex items-center justify-center opacity-20"><p className="text-2xl font-bold">VUI L√íNG CH·ªåN B√ÄI H·ªåC</p></div>
                            )}
                        </div>
                    </main>
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
