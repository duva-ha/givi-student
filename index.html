<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-TECH Hub 2026 - Student Official</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <script src="bai1-10.js" defer></script>
    <script src="bai2-10.js" defer></script>
    <script src="bai1-11.js" defer></script>
    <script src="bai2-11.js" defer></script>
    <script src="bai1-12.js" defer></script>
    <script src="bai2-12.js" defer></script>
    <script src="quizzes.js" defer></script>
    <script src="LTAP1.js" defer></script>
    <script src="LTAP2.js" defer></script>
    <script src="TLIEU1.js" defer></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #fdfdfb; margin: 0; overflow: hidden; color: #334155; }
        aside { background: #1e293b; width: 260px; flex-shrink: 0; transition: all 0.4s ease; }
        .nav-active { background: rgba(255,255,255,0.1); border-left: 3px solid #3b82f6; color: white; }
        .custom-scroll::-webkit-scrollbar { width: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .modal-overlay { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); }
        .hide-sidebar { transform: translateX(-100%); width: 0 !important; opacity: 0; }
        .logout-btn:hover { background: rgba(244, 63, 94, 0.2); color: #fb7185; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyAV-XVaOyUiq1c-29VTaWjLKcEXrssnnTE",
            authDomain: "qlhs10a7.firebaseapp.com",
            projectId: "qlhs10a7",
            storageBucket: "qlhs10a7.firebasestorage.app",
            appId: "1:584229565603:web:d47a10f0a512a1a309bb16"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- H√ÄM THO√ÅT ·ª®NG D·ª§NG ---
        const handleLogout = () => {
            if (window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën tho√°t ·ª©ng d·ª•ng?")) {
                auth.signOut().then(() => {
                    window.location.reload();
                });
            }
        };

        function App() {
            const [user, setUser] = useState(null);
            const [tab, setTab] = useState('baigiang');
            const [grade, setGrade] = useState('11');
            const [isFocus, setIsFocus] = useState(false);
            const [localLessons, setLocalLessons] = useState({ "10": [], "11": [], "12": [] });
            const [practiceData, setPracticeData] = useState([]);
            const [docData, setDocData] = useState([]);

            useEffect(() => {
                const unsub = auth.onAuthStateChanged(u => setUser(u));
                const scanTimer = setInterval(() => {
                    // Qu√©t b√†i gi·∫£ng
                    const resLessons = { "10": [], "11": [], "12": [] };
                    ["10", "11", "12"].forEach(g => {
                        for (let i = 1; i <= 20; i++) {
                            const d = window[`D${g}_B${i}`];
                            if (d) resLessons[g].push({ ...d, lessonIndex: i });
                        }
                    });
                    // Qu√©t luy·ªán t·∫≠p & t∆∞ li·ªáu
                    const resP = []; const resD = [];
                    for (let i = 1; i <= 10; i++) {
                        if (window[`LTAP${i}`]) resP.push(window[`LTAP${i}`]);
                        if (window[`TLIEU${i}`]) resD.push(window[`TLIEU${i}`]);
                    }
                    setLocalLessons(resLessons);
                    setPracticeData(resP);
                    setDocData(resD);
                }, 1000);
                return () => { unsub(); clearInterval(scanTimer); };
            }, []);

            if (!user) return (
                <div className="h-screen flex items-center justify-center bg-slate-900">
                    <div className="text-center">
                        <div className="w-20 h-20 bg-blue-600 rounded-3xl flex items-center justify-center text-white font-black italic text-4xl shadow-2xl mx-auto mb-8">E</div>
                        <h1 className="text-white font-bold text-xl mb-6 tracking-tight">E-TECH HUB 2026</h1>
                        <button onClick={() => auth.signInWithPopup(new firebase.auth.GoogleAuthProvider())} className="bg-white text-slate-900 px-10 py-4 rounded-2xl font-black uppercase text-[10px] tracking-widest hover:scale-105 transition-all shadow-xl">ƒêƒÉng nh·∫≠p b·∫±ng Google</button>
                    </div>
                </div>
            );

            return (
                <div className="flex h-screen overflow-hidden">
                    {/* SIDEBAR */}
                    <aside className={`flex flex-col p-6 z-50 transition-all duration-500 shadow-xl ${isFocus ? 'hide-sidebar' : ''}`}>
                        <div className="mb-10 px-4 font-black text-2xl text-blue-500 italic uppercase tracking-tighter">E-Tech Hub</div>
                        <nav className="flex-1 space-y-1">
                            {[
                                {id: 'baigiang', label: 'B√†i gi·∫£ng', icon: 'üìñ'},
                                {id: 'luyentap', label: 'Luy·ªán t·∫≠p', icon: 'üìù'},
                                {id: 'kiemtra', label: 'Ki·ªÉm tra', icon: 'üéØ'},
                                {id: 'tuliaeu', label: 'T∆∞ li·ªáu', icon: 'üìö'}
                            ].map(t => (
                                <button key={t.id} onClick={() => setTab(t.id)} className={`w-full flex items-center gap-4 px-6 py-4 text-[10px] font-black uppercase tracking-widest rounded-xl transition-all ${tab === t.id ? 'nav-active text-white shadow-lg' : 'text-slate-500 hover:text-white'}`}>
                                    <span className="text-lg">{t.icon}</span> {t.label}
                                </button>
                            ))}
                        </nav>

                        {/* USER PANEL + LOGOUT */}
                        <div className="mt-auto space-y-2">
                            <div className="p-3 bg-slate-800/50 rounded-2xl flex items-center gap-3 border border-white/5">
                                <img src={user.photoURL} className="w-8 h-8 rounded-full border border-blue-500/50" />
                                <div className="truncate flex-1">
                                    <p className="text-[9px] font-black text-white uppercase truncate">{user.displayName}</p>
                                    <p className="text-[7px] text-slate-500 truncate">{user.email}</p>
                                </div>
                            </div>
                            <button onClick={handleLogout} className="w-full flex items-center justify-center gap-2 p-3 rounded-xl text-[9px] font-bold uppercase tracking-widest text-slate-400 logout-btn transition-all">
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                                Tho√°t ·ª©ng d·ª•ng
                            </button>
                        </div>
                    </aside>

                    {/* MAIN CONTENT (Gi·ªØ nguy√™n logic c√°c Tab nh∆∞ tr∆∞·ªõc) */}
                    <main className="flex-1 bg-white relative rounded-l-[2.5rem] shadow-2xl overflow-hidden flex flex-col border-l border-slate-100">
                        <header className="h-14 px-8 border-b flex items-center justify-between bg-white/80 backdrop-blur-md z-40">
                             <div className="flex items-center gap-4 font-black text-[10px] uppercase text-slate-400 tracking-widest">
                                <span>Kh·ªëi l·ªõp</span>
                                <select value={grade} onChange={e=>setGrade(e.target.value)} className="bg-transparent font-black text-blue-600 outline-none cursor-pointer">
                                    <option value="12">L·ªõp 12</option><option value="11">L·ªõp 11</option><option value="10">L·ªõp 10</option>
                                </select>
                            </div>
                            <button onClick={() => setIsFocus(!isFocus)} className="w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-100 text-slate-400">
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" /></svg>
                            </button>
                        </header>

                        {/* RENDER CONTENT T∆Ø∆†NG ·ª®NG TAB */}
                        <div className="flex-1 overflow-hidden">
                           {/* Logic render B√†i gi·∫£ng, Luy·ªán t·∫≠p, Ki·ªÉm tra, T∆∞ li·ªáu ·ªü ƒë√¢y... */}
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
